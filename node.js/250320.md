
클로저를 사용하면 로그인 성공했을 때, 자기가 장바구니에 넣어 놓는 것을 .......순수함수

클로저를 사용할 때 부작용을 최소화시켜야한다.......

순수함수는 값( )을 외부에 두지 않는다. 클로저는 값을 외부에 둔다.




스테이트가 바뀌면 돔이 바뀐다. 

유아이를 조정해서 상태를 바꾸는 것이다.

상태(Value)가 바뀌면 유아이가 바뀐다. 이것은 리턴 값(Value)에서 값이 보여지기 때문에.

이러면 사용자 맞춤에 따라 유아이가 바뀐다.

여기서 상태 관리자가 등장한다.

UseStates는  은닉화 시켜야한다. 

그래서 순수함수는 노출시키고, 클로저는 감춰야한다. 클로저는 




UseState를 바꾸고 싶다.



아래 부모 component이다.
![[Pasted image 20250320105623.png]]


입력 값이 있고, 리턴 값이 있으면 순수 함수이다.

- 상태 = 예시) onChange, Submit.......




- 부모 컴포넌트는 상태(State)가 무조건 없어야 한다. 


부모컴포넌트와 자식컴포넌트를 나누는게 무상태 프로그래밍이다.

특징: 필드가 없다(return값 만 있다). 다 에어리어만 있는 느낌이다.


파이썬에서 "상태"는 프로퍼티이다. 


useclient가 클로저이다. 


변경 가능한 데이터(mutable data) 및 부작용(side-effects)을 피하는 기본 원칙에 따라 소프트웨어를 구성하는 프로그래밍 패러다임이다.

FP(함수형 프로그래밍)가 뭐야?

feature : 숫자화 된 특성을 의미함.



mutable: 객체가 변할 수 있는 것... 컴포넌트가 변하는게 mutable이다. 변이된 것을 의미함. a --> b

함수형 프로그래밍에서 뮤터블을 원하지 않는다. 

immuatable: 외관이 바뀌는데, 속성이 똑같다.



valabe:  a --> a* 로 바뀌는 것을 의미함.






valable: 데이터를 저장하는 컨테이너 자체가 아톰 자체가 다른 아톰 자체로 바뀌는 것...
물이 다른 거로 마뀌는 것


객체의 변화..객체의 속성 값.이 변하는 것...


함수형 프로그래밍은 순수함수이고, 공유상태, 변경가능한 데이터, 및 부작용을 피한다. 



usestate를 캡슐화한다. 


### @page.tsx 여기에다가 onChange={(e) => setName(e.target.value)} 이거를 handleChange로 변경해주고, handleSubmit 내부에 axios를 추가해줘. 그리고 swagger 주소는 http://localhost:8000/api/customer/create이거야. 보내기 전에 alert기능을 추가해줘



흐름 제어 - loo[p, branch


1급 객체 


매트릭스 구조상에서 평면적으로 움직였다. (부모에서 자식으로 상속받을 때)

리엑트에서 상속은 평면적으로 움직이는게 아니다.


함수형 프로그래밍 조건

1)   
- 상태변경을 하지 않는게 아니라 상태 변경이 없다. 


순수함수: return값만 있다. state가 없다.
순수함수는 immutable이다. side

자바스크립트에서 함수는 1급 객체이고, 클래스는 1급 객체가 아니다

파이썬에서 1급 객체는 ....?

명시적으로 쓰는 건 -for, if, elipf를 쓰는 것을 의미함

바뀐건 모르는데, DB가 마지막에 바뀌어있다. --> 
\

### **퍼시스트 레이어(Persistence Layer)란?**

퍼시스트 레이어(**Persistence Layer**)는 **데이터를 영구적으로 저장(Persist)하는 계층**을 의미해.


### 🔥 **ACID란?**

**ACID**는 **데이터베이스 트랜잭션이 안정적으로 처리되도록 보장하는 4가지 핵심 원칙**을 의미해.  
데이터베이스에서 **데이터의 무결성(Integrity)과 신뢰성(Reliability)을 보장하기 위해 반드시 지켜야 하는 규칙**이야.

---

### ✅ **ACID 4가지 원칙**

|원칙|설명|
|---|---|
|**A (Atomicity, 원자성)**|트랜잭션이 "모두 수행되거나, 전혀 수행되지 않아야 함" (All or Nothing)|
|**C (Consistency, 일관성)**|트랜잭션이 수행된 후에도 데이터가 항상 **일관된 상태**를 유지해야 함|
|**I (Isolation, 고립성)**|여러 트랜잭션이 동시에 실행될 때, 서로의 작업이 영향을 주지 않아야 함|
|**D (Durability, 지속성)**|트랜잭션이 완료된 후에는 데이터가 영구적으로 저장되어야 함|


퍼시스트를 

퍼시스트(persist)를 써서 상태가 안변했을 때, 연결을 안시키고, 갖고 있겠다는 것을 의미함.


### 함수형 프로그래밍 하는 작업(chat gpt물어볼 때 확인하기)


Q. 파일 구조는 아래와 같고, 나는 함수형 프로그래밍을 사용해서 부모 comonent와 자식 component를 분리하고 싶다. 부모 component는 무상태이고,. 자식은 커스텀 훅과 컴포넌트로 분리할거야. 커스텀 훅은 상태 및 로직을 관리할 것이다. 그리고 컴포넌트는 UI를 맡을 것이다.그리고 react component는 immutable로 처리할거야.

아래 부분은 상태를 담당하는 녀석이야/.
```ts
export default function Signup() {

  

    const [form, setForm] = useState({

    user_id: "",

    email: "",

    password: "",

    confirmPassword: "",

    name: "",

  });

  

  const [error, setError] = useState("");

  

  const handleChange = (e: any) => {

    setForm({ ...form, [e.target.name]: e.target.value });

  };

  

  const handleSubmit = async (e: any) => {

    e.preventDefault();

    if (form.password !== form.confirmPassword) {

      setError("Passwords do not match");

      return;

    }

    if (form.user_id.length < 3 || form.user_id.length > 10) {

      setError("User ID must be between 3 and 10 characters");

      return;

    }

    setError("");

  
  

    console.log("Form submitted", form);

  

    try {

      const response = await axios.post("http://localhost:8000/api/customer/create", {

        user_id: form.user_id,

        email: form.email,

        password: form.password,

        name: form.name,

      });

  

      // 성공 메시지 설정

      console.log("Signup success:", response.data);

    } catch (err: any) {

      setError("Signup failed. Please try again.");

      console.error("Signup error:", err.response?.data || err.message);

    }

  };
```

아래 부분은 가상 돔을 담당하는 녀석이야.
```ts
return (

    <div className="flex justify-center items-center h-screen bg-gray-100">

      <div className="bg-white p-6 rounded-lg shadow-md w-96">

        <h2 className="text-2xl font-bold text-center mb-4">Guest Sign Up</h2>

        <form onSubmit={handleSubmit}>

          <input

            type="text"

            name="user_id"

            placeholder="User ID"

            value={form.user_id}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          <input

            type="email"

            name="email"

            placeholder="Email"

            value={form.email}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          <input

            type="text"

            name="name"

            placeholder="Name"

            value={form.name}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          <input

            type="password"

            name="password"

            placeholder="Password"

            value={form.password}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          <input

            type="password"

            name="confirmPassword"

            placeholder="Confirm Password"

            value={form.confirmPassword}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          {error && <p className="text-red-500 text-sm mb-2">{error}</p>}

          <button

            type="submit"

            className="w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600"

          >

            Sign Up

          </button>

        </form>

        <p className="text-center text-sm text-gray-600 mt-4">

          Already have an account? <a href="/login" className="text-blue-500">Log in</a>

        </p>

      </div>

    </div>

  );

}
```

아래와 같이 **함수형 프로그래밍 방식으로 부모 컴포넌트와 자식 컴포넌트를 분리**하고,  
**부모 컴포넌트는 무상태(stateless)로 유지**하며, **React 컴포넌트는 Immutable하게 처리**하도록 수정하겠습니다.


함수형 프로그래밍 하기 전....
```JS
"use client";

  

import { useState } from "react";

import axios from "axios";

  

export default function Signup() {

  

    const [form, setForm] = useState({

    user_id: "",

    email: "",

    password: "",

    confirmPassword: "",

    name: "",

  });

  

  const [error, setError] = useState("");

  

  const handleChange = (e: any) => {

    setForm({ ...form, [e.target.name]: e.target.value });

  };

  

  const handleSubmit = async (e: any) => {

    e.preventDefault();

    if (form.password !== form.confirmPassword) {

      setError("Passwords do not match");

      return;

    }

    if (form.user_id.length < 3 || form.user_id.length > 10) {

      setError("User ID must be between 3 and 10 characters");

      return;

    }

    setError("");

  
  

    console.log("Form submitted", form);

  

    try {

      const response = await axios.post("http://localhost:8000/api/customer/create", {

        user_id: form.user_id,

        email: form.email,

        password: form.password,

        name: form.name,

      });

  

      // 성공 메시지 설정

      console.log("Signup success:", response.data);

    } catch (err: any) {

      setError("Signup failed. Please try again.");

      console.error("Signup error:", err.response?.data || err.message);

    }

  };

  
  
  

  return (

    <div className="flex justify-center items-center h-screen bg-gray-100">

      <div className="bg-white p-6 rounded-lg shadow-md w-96">

        <h2 className="text-2xl font-bold text-center mb-4">Guest Sign Up</h2>

        <form onSubmit={handleSubmit}>

          <input

            type="text"

            name="user_id"

            placeholder="User ID"

            value={form.user_id}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          <input

            type="email"

            name="email"

            placeholder="Email"

            value={form.email}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          <input

            type="text"

            name="name"

            placeholder="Name"

            value={form.name}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          <input

            type="password"

            name="password"

            placeholder="Password"

            value={form.password}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          <input

            type="password"

            name="confirmPassword"

            placeholder="Confirm Password"

            value={form.confirmPassword}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          {error && <p className="text-red-500 text-sm mb-2">{error}</p>}

          <button

            type="submit"

            className="w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600"

          >

            Sign Up

          </button>

        </form>

        <p className="text-center text-sm text-gray-600 mt-4">

          Already have an account? <a href="/login" className="text-blue-500">Log in</a>

        </p>

      </div>

    </div>

  );

}
```


### 🔹 **1. 부모 컴포넌트 (`page.tsx`)**

✅ **역할:**

- 상태 없음 (무상태)
- `SignupForm`을 렌더링

```js
// guest/templates/create_guest/page.tsx
"use client";
import SignupForm from "./components/SignupForm";

export default function Signup() {
  return <SignupForm />;
}

```

✅ **완전히 무상태 (State 없음)**

- 부모는 단순히 `SignupForm`을 렌더링하는 역할만 함
- 상태는 `SignupForm.tsx`에서 관리

### 🔹 **2. 자식 컴포넌트 (`SignupForm.tsx`)**

✅ **역할:**

- UI 렌더링만 담당
- 상태(`form`, `error`), 이벤트 핸들러(`handleChange`, `handleSubmit`)도 모두 내부에서 처리

```js
// app/signup/components/SignupForm.tsx

import React from "react";

import { useSignupForm } from "@/hooks/(account)/guest/new/useSignupForm";

  

const SignupForm: React.FC = () => {

  const { form, error, handleChange, handleSubmit } = useSignupForm();

  

  return (

    <div className="flex justify-center items-center h-screen bg-gray-100">

      <div className="bg-white p-6 rounded-lg shadow-md w-96">

        <h2 className="text-2xl font-bold text-center mb-4">Guest Sign Up</h2>

        <form onSubmit={handleSubmit}>

          <input

            type="text"

            name="user_id"

            placeholder="User ID"

            value={form.user_id}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          <input

            type="email"

            name="email"

            placeholder="Email"

            value={form.email}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          <input

            type="text"

            name="name"

            placeholder="Name"

            value={form.name}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          <input

            type="password"

            name="password"

            placeholder="Password"

            value={form.password}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          <input

            type="password"

            name="confirmPassword"

            placeholder="Confirm Password"

            value={form.confirmPassword}

            onChange={handleChange}

            className="w-full p-2 border rounded mb-2"

            required

          />

          {error && <p className="text-red-500 text-sm mb-2">{error}</p>}

          <button

            type="submit"

            className="w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600"

          >

            Sign Up

          </button>

        </form>

        <p className="text-center text-sm text-gray-600 mt-4">

          Already have an account? <a href="/login" className="text-blue-500">Log in</a>

        </p>

      </div>

    </div>

  );

};

  

export default SignupForm;

```

자식 컴포넌트 - custom hook

```ts
// app/signup/hooks/useSignupForm.ts

import { useState } from "react";

import axios from "axios";

  

export function useSignupForm() {

  const [form, setForm] = useState({

    user_id: "",

    email: "",

    password: "",

    confirmPassword: "",

    name: "",

  });

  

  const [error, setError] = useState("");

  

  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {

    setForm((prevForm) => ({ ...prevForm, [e.target.name]: e.target.value }));

  };

  

  const handleSubmit = async (e: React.FormEvent) => {

    e.preventDefault();

    if (form.password !== form.confirmPassword) {

      setError("Passwords do not match");

      return;

    }

    if (form.user_id.length < 3 || form.user_id.length > 10) {

      setError("User ID must be between 3 and 10 characters");

      return;

    }

    setError("");

  

    try {

      const response = await axios.post("http://localhost:8000/api/customer/create", {

        user_id: form.user_id,

        email: form.email,

        password: form.password,

        name: form.name,

      });

  

      console.log("Signup success:", response.data);

    } catch (err: any) {

      setError("Signup failed. Please try again.");

      console.error("Signup error:", err.response?.data || err.message);

    }

  };

  

  return { form, error, handleChange, handleSubmit };
```
### ✅ **구현 방식 정리**

#### ✅ **부모 컴포넌트 (`page.tsx`)**

- **완전히 무상태(stateless)**
- `SignupForm`만 렌더링하는 역할

#### ✅ **자식 컴포넌트 (`SignupForm.tsx`)**

- **UI 렌더링만 담당**
- 상태 (`form`, `error`), 이벤트 핸들러 (`handleChange`, `handleSubmit`)를 내부에서 처리
- React의 Immutable 원칙 유지 (`useState` 활용)

---

### ✅ **이 코드의 장점**

1️⃣ **부모는 완전한 무상태 → 역할이 명확해짐**  
2️⃣ **SignupForm이 UI와 상태를 독립적으로 관리 → 재사용 가능**  
3️⃣ **React의 Immutable 원칙 유지 → 상태를 직접 변경하지 않음**  
4️⃣ **컴포넌트가 단순해지고, 유지보수가 쉬워짐**

---

### ✅ **결론**

- **부모(`page.tsx`)는 상태가 없고, 단순히 `SignupForm`을 렌더링**
- **자식(`SignupForm.tsx`)은 UI만 담당하면서, 내부적으로 상태를 관리**
- **함수형 프로그래밍 패턴을 유지하면서, React의 Immutable 원칙을 지킴**

🔥 **이제 코드가 깔끔하고 유지보수가 쉬운 구조로 최적화되었어! 🚀**




### ✅ **Next.js에서 괄호 `( )`가 있는 폴더와 없는 폴더의 차이**

Next.js **App Router(`app` 디렉토리 기반 라우팅)**에서는 **폴더 이름에 괄호 `()`가 있는 경우와 없는 경우의 차이점**이 있습니다.

| 폴더 타입                                              | 설명                      |     |
| -------------------------------------------------- | ----------------------- | --- |
| **괄호 없는 폴더 (`app/dashboard/page.tsx`)**            | 실제 라우트(URL)를 생성함        |     |
| **괄호 있는 폴더 (`app/(dashboard)/settings/page.tsx`)** | URL에 영향을 주지 않음 (그룹화 역할) |     |


### ✅ **"무상태(stateless) 컴포넌트"란?**

"무상태(stateless) 컴포넌트"란 **내부적으로 상태(`useState` 또는 `useReducer`)를 관리하지 않는 컴포넌트**를 의미합니다.  
즉, **상태(state)를 갖지 않고, props(속성)를 받아서 UI를 렌더링하는 역할만 하는 컴포넌트**입니다.


## 🔹 **4. 왜 무상태 컴포넌트가 중요할까?**

✔ **재사용성 증가** → 같은 컴포넌트를 여러 곳에서 사용 가능  
✔ **유지보수 용이** → 상태 변경 없이 UI만 렌더링하므로 코드가 단순해짐  
✔ **성능 최적화** → 불필요한 리렌더링을 줄이고, `React.memo()` 적용 가능


**"상태(State)"란 시간이 지나면서 변할 수 있는 데이터이며, React에서는 `useState`, `useReducer`, `useContext` 등을 사용해 상태를 관리할 수 있음!** 🚀



로그인 페이지 원본
```JS
"use client";

  

import Link from "next/link";

import { useState, FormEvent } from "react";

import { useRouter } from "next/navigation";

  

export default function LoginPage() {

  const [username, setUsername] = useState("");

  const [password, setPassword] = useState("");

  const [error, setError] = useState("");

  const [isSuccess, setIsSuccess] = useState(false);

  const router = useRouter();

  

  const handleSubmit = async (e: FormEvent<HTMLFormElement>) => {

    e.preventDefault();

    // 간단한 유효성 검사

    if (!username || !password) {

      setError("아이디와 비밀번호를 모두 입력해주세요.");

      return;

    }

  

    try {

      // 실제로는 여기서 API 호출을 통해 로그인 처리를 해야 합니다.

      // 예시 코드이므로 아이디가 'aaa'이고 비밀번호가 'bbb'일 때만 성공하도록 함

      if (username === "aaa" && password === "bbb") {

        setIsSuccess(true);

        setError("");

        // 성공 후 3초 후에 메인 페이지로 리다이렉트

        setTimeout(() => {

          router.push('/dashboard/common/user/templates');

        }, 3000);

      } else {

        setError("아이디 또는 비밀번호가 올바르지 않습니다.");

        setIsSuccess(false);

      }

    } catch (err) {

      setError("로그인 중 오류가 발생했습니다. 다시 시도해주세요.");

      setIsSuccess(false);

    }

  };

  

  return (

    <div className="min-h-screen bg-gray-100 p-4">

      <div className="absolute top-4 right-4 flex gap-3">

        <Link href="/" className="px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors">

          홈

        </Link>

        <Link href="/auth/login" className="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors">

          로그인

        </Link>

      </div>

      <div className="flex flex-col items-center justify-center min-h-screen">

        {isSuccess ? (

          // 로그인 성공 화면

          <div className="bg-white p-8 rounded-lg shadow-md w-full max-w-md">

            <div className="text-center">

              <div className="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">

                <svg xmlns="http://www.w3.org/2000/svg" className="h-10 w-10 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">

                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />

                </svg>

              </div>

              <h2 className="text-2xl font-bold text-gray-800 mb-2">로그인 성공!</h2>

              <p className="text-gray-600 mb-4">환영합니다. 잠시 후 대시보드로 이동합니다.</p>

              <div className="mt-6">

                <Link href="/dashboard/common/user/templates" className="text-blue-600 hover:underline">

                  지금 바로 대시보드로 이동

                </Link>

              </div>

            </div>

          </div>

        ) : (

          // 로그인 폼

          <div className="bg-white p-8 rounded-lg shadow-md w-full max-w-md">

            <h2 className="text-2xl font-bold text-center text-gray-800 mb-6">로그인</h2>

            {error && (

              <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">

                <span className="block sm:inline">{error}</span>

              </div>

            )}

            <form className="space-y-6" onSubmit={handleSubmit}>

              <div>

                <label htmlFor="username" className="block text-sm font-medium text-gray-700 mb-1">아이디</label>

                <input

                  id="username"

                  type="text"

                  required

                  className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"

                  placeholder="아이디를 입력하세요"

                  value={username}

                  onChange={(e) => setUsername(e.target.value)}

                />

              </div>

              <div>

                <label htmlFor="password" className="block text-sm font-medium text-gray-700 mb-1">비밀번호</label>

                <input

                  id="password"

                  type="password"

                  required

                  className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"

                  placeholder="비밀번호를 입력하세요"

                  value={password}

                  onChange={(e) => setPassword(e.target.value)}

                />

              </div>

              <div>

                <button

                  type="submit"

                  className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors"

                >

                  로그인

                </button>

              </div>

            </form>

            <div className="mt-6 text-center">

              <span className="text-sm text-gray-600">계정이 없으신가요? </span>

              <Link href="/auth/register" className="text-sm text-blue-600 hover:underline">

                회원가입

              </Link>

            </div>

          </div>

        )}

      </div>

    </div>

  );

}
```