
- 참고 사이트: https://wikidocs.net/222892


#### 개발
- ai-server, api-server- 백엔드 개발
- app-server, web-server - 프론트 엔드 개발


#### 머신러닝(ML) vs 딥러닝(DL)

- 인공신경망(ANN)에 대한 유무, 즉 뉴런에 대한 유무
- 머신러닝은 사람이 훈련을 시킨다. 인공신경망을 가지고 있지 않다.
- 딥러닝은 인공지능이 훈련을 시켜야 한다. 인공신경망을 가지고 있다. 

#### 딥러닝은 ANN과 DNN으로 쪼개진다.
- ANN과 DNN의 차이: 은닉충의 갯수의 차이
- ANN: 은닉충이 한개(단수)
- DNN: 은닉충이 여러개(복수)
- 공부 순서: 머신러닝 --> ANN --> DNN


##### 딥러닝
딥러닝의 도구: 텐서플로어와 파이토치
머신러닝의 도구: 넘파이, 판다스

##### 머신러닝
머신러닝의 도구: 넘파이, 판다스, 사이킷 런

- 넘파이: 숫자 처리하는 도구이다.
- 판다스: 문자 처리하는 도구이다. 이미 프레임워크에 내장되어 ㅣㅇㅆ다.
- 넘파이는 판다스에 속한다. 판다스가 더 크다.
- 사이킷 런: 머신러닝 알고리즘을 쉽게 사용하게 해주는 파이썬 라이브러리이다. 사이킷: 과학 도구 상자, 런: 머신 러닝을 의미함.



#### v2 - ai-server 폴더 만들기
- DB 안 필요하다. 뉴런에 대한 데이터 연속성은 필요 없다. 데이터를 저장할 필요가 없다. api가 갖다 써야한다. api는 디비만 봤지만, 이제는 api는 ai를 봐야한다. 
- 라우터 필요 없다.
- 컨트롤러, 서비스 필요하다.  


나 ai 서버 만들거야. 이건 머신러닝이 아니고, 딥러닝이야.  



### ai-server 프롬프팅 하는 방법

![[Pasted image 20250424104519.png]]

📁 app/ ├── 📁 controller/ ← API 라우터 정의 │ └── predict_controller.py ├── 📁 service/ ← 비즈니스 로직 │ └── predict_service.py ├── main.py ← FastAPI 앱 실행 ├── model.pkl ← 저장된 ML 모델 📄 Dockerfile ← 도커 이미지 정의 📄 requirements.txt ← 의존 패키지 리스트 📄 .dockerignore ← 도커 빌드시 제외할 파일 목록 📄 README.md ← 프로젝트 설명서 나는 머신러닝 모델을 FastAPI 기반 API 서버로 배포하고 싶어. 전체 프로젝트를 다음 구조로 구성해줘: - controller/: FastAPI의 API 엔드포인트 라우팅 - service/: 머신러닝 모델 불러오고 예측 처리 - main.py: FastAPI 앱 실행 - model.pkl: 사전에 학습된 모델 (scikit-learn으로 저장됨) - requirements.txt: 필요한 Python 패키지 목록 - Dockerfile: Docker 환경에서 실행되도록 구성, Python 3.12.7 기반, `--reload` 옵션 포함 - .dockerignore: 불필요한 파일 제외 - README.md: 간단한 사용 설명서 포함 요구 사항: - 모델은 `model.pkl`에서 로드하여 `/predict` POST API에서 예측할 수 있게 해줘. - 입력은 JSON 형식, 출력은 예측 결과 리턴 - 가능한 최소한의 코드로 구성하되, 가독성은 유지 - 전체 코드를 완성된 형태로 디렉토리 구조별로 나눠서 보여줘.

##### main.py에 관련된 프롬프팅(컨트롤러만 호출하기)
- **나 지금 ai-serserver를 만들고 있어.** main.py는 라우터와 middleware 기능을 삭제해줘. 그리고 @titanic_controller.py 타이타닉 컨트롤러를 호출할 수 있는  로직을 작성해줘.(컨트롤러 기능을 호출하는게 아니라 컨트롤러만 호출하는 것이다.)

```main.py(전체 라우터임)
from app.domain.controller.titanic_controller import TitanicController

from app.domain.controller.matzip_controller import MatjibController

from app.domain.controller.crime_controller import CrimeController

  

def main():

    # Titanic 모델 실행

    titanic_controller = TitanicController()

    print("Titanic 모델 실행 시작")

    titanic_controller.preprocess()

    titanic_controller.learning()

    titanic_controller.evaluation()

    titanic_controller.deployment()

    print("Titanic 모델 실행 완료")

    # Matzip 모델 실행

    matzip_controller = MatjibController()

    print("\nMatzip 모델 실행 시작")

    matzip_controller.preprocess()

    matzip_controller.learning()

    matzip_controller.evaluation()

    matzip_controller.deployment()

    print("Matzip 모델 실행 완료")

    # Crime 모델 실행

    crime_controller = CrimeController()

    print("\nCrime 모델 실행 시작")

    crime_controller.preprocess("cctv_in_seoul.csv", "crime_in_seoul.csv", "pop_in_seoul.xls")

    crime_controller.learning()

    crime_controller.evaluation()

    crime_controller.deployment()

    print("Crime 모델 실행 완료")

  

if __name__ == "__main__":

    main()
```

``` main.py(맛집)
from app.domain.controller.matzip_controller import MatZipController

  

def main():

    controller = MatZipController()

    # matzip.csv 파일을 사용하여 맛집 모델링 수행

    matzip_fname = 'matzip.csv'

    result = controller.modelling(matzip_fname)

    print("🥘 맛집 모델링 완료 🥘",result)

  

if __name__ == "__main__":

    main()
```

##### controller.py에 관련된 프롬프팅(서비스만 호출하기) - 아래는 기본 구조임 

```matzip_controller.py
from app.domain.service.matzip_service import MatZipService

  

class MatZipController:

    service = MatZipService()

    def preprocess(self, matzip_fname):

        pass

    def learning(self):

        pass

    def evaluation(self):

        pass

    def submit(self):

        pass
```


##### service.py에 관련된 프롬프팅(스키마 만 호출하기)


#### 프롬프팅에서 배운 개념
##### api-server에서 모델의 개념: 
- entity와 schema을 말한다. 
-  둘다 데이터베이스의 컬럼과 일치한다. 
- 스키마는 클라이언트의 요청을 받았을 때, 타입을 연결해주는 것. 스레드에서 작동된다.
- 엔티티는 DB한테 주입할 때 컬럼이 정의되어 있다. 트렌젝션(TSX)에서 작동된다.
##### 사이킷 런이 피클이다. 근데 사이킷 런은 머신러닝에서 쓰이기 때문에, 딥러닝에서 안쓰인다. 근데 쓰이긴 한다. 피클은 모델이다. 

api-server와 ai-server의 확장자가 py이냐 pkl이냐의 차이에 따라 다른다. 

학습되기 전 -->py로 저장하고, 학습되고 난 후 --> pkl로 저장한다. (머신러닝에서)

#### 지도학습과 비지도학습
- 라벨이 있으면 지도학습, 라벨이 없으면 비지도학습을 의미한다.
- 지도학습은 분류모델과 회귀모델로 나뉜다. <-- **프롬프팅 할 때 써야할 말**
- 타이타닉은 분류 모델로 나뉘어야한다. yes or no로 나뉠 수 있을 때 쓰인다.
- 부동산 가격 예측, 기후 예측, 주가 예측은 회귀 모델로 나뉜다.
- 비지도학습은 군집화(클러스터), 변환(트렌스포메이션)로 나뉜다.


##### main.py에 관련된 프롬프팅
- **나 지금 ai-serserver를 만들고 있어.** main.py는 라우터와 middleware 기능을 삭제해줘. 그리고 @titanic_controller.py 타이타닉 컨트롤러를 호출할 수 있는  로직을 작성해줘.(컨트롤러 기능을 호출하는게 아니라 컨트롤러만 호출하는 것이다.)





#### 타이타닉 프롬프팅 2차(아주 세분화되었음)
  
1. @main.py @titanic_controller.py 여기에 있는 메소드를 실행하도록 main.py를 작성해줘.
2. @titanic_controller.py 여기에서 @titanic_service.py preprocess룰 호출하는 코드를 작성해줘
3.  도커에 올리지 않은 상황에서 실행할 때, @main.py 여기에서 실행하도록 해줘. 단, 도커를 사용하지 않고 레거시 방식으로 실행해줘.

###### (결과물)
```
PS C:\Users\bitcamp\Documents\kpmg-250424\k
---------모델 전처리 시작 ----------
트레인 데이터
     PassengerId  Survived  Pclass         
0              1         0       3         
1              2         1       1  Cumings
2              3         1       3         
3              4         1       1       Fu
4              5         0       3         
..           ...       ...     ...         
886          887         0       2         
887          888         1       1         
888          889         0       3         
889          890         1       1         
890          891         0       3         

[891 rows x 12 columns]
테스트 데이터
🚚🚚a ['Don', 'Rev', 'Dr', 'Miss', 'Sir', '
😡😷🤢title_nominal 메쏘드 성공
🥟🍗🍗gender_nominal 메쏘드 성공
👦👩‍🦰👨‍🦰👱‍♂️embarked_norminal 메쏘드 성공
👮‍♀️🧔😶😪🙄최고령자 80.0
🍜🥩🧵🎞----age_ratio 성공------
😎😪😫🙄----fare _ratio 처음--------
😎😪😫🙄----fare _ratio 끝--------
👮‍♀️🧔😶😪🙄비용 512.3292
🎉🎉✨✨: 0      1
1      1
2      1
3      1
4      1
      ..
886    1
887    1
888    1
889    1
Name: FareGroup, Length: 891, dtype: catego
Categories (4, int64): [1 < 2 < 3 < 4]
🎉🎉✨✨: 0      1
1      1
2      1
3      1
4      1
      ..
413    1
414    1
415    1
416    1
417    1
Name: FareGroup, Length: 418, dtype: catego
Categories (4, int64): [1 < 2 < 3 < 4]
전처리 완료
PS C:\Users\bitcamp\Documents\kpmg-250424\k
---------모델 전처리 시작 ----------
트레인 데이터
     PassengerId  Survived  Pclass         
0              1         0       3         
1              2         1       1  Cumings
2              3         1       3         
3              4         1       1       Fu
4              5         0       3         
..           ...       ...     ...         
886          887         0       2         
887          888         1       1         
888          889         0       3         
889          890         1       1         
890          891         0       3         

[891 rows x 12 columns]
테스트 데이터
🚚🚚a ['Miss', 'Ms', 'Jonkheer', 'Dona', 'D
😡😷🤢title_nominal 메쏘드 성공
🥟🍗🍗gender_nominal 메쏘드 성공
👦👩‍🦰👨‍🦰👱‍♂️embarked_norminal 메쏘드 성공
👮‍♀️🧔😶😪🙄최고령자 80.0
🍜🥩🧵🎞----age_ratio 성공------
😎😪😫🙄----fare _ratio 처음--------
😎😪😫🙄----fare _ratio 끝--------
👮‍♀️🧔😶😪🙄비용 512.3292
🎉🎉✨✨: 0      1
1      1
2      1
3      1
4      1
      ..
886    1
887    1
888    1
889    1
890    1
Name: FareGroup, Length: 891, dtype: catego
Categories (4, int64): [1 < 2 < 3 < 4]
🎉🎉✨✨: 0      1
1      1
2      1
3      1
4      1
      ..
413    1
414    1
415    1
416    1
417    1
Name: FareGroup, Length: 418, dtype: catego
Categories (4, int64): [1 < 2 < 3 < 4]
😚☺🙂🤗전처리 완료 DataSchema(context='C:\\
        Name     Sex   Age  SibSp  Parch   
0              1       3                   
1              2       1  Cumings, Mrs. Joh
2              3       3                   
3              4       1       Futrelle, Mr
4              5       3                   
..           ...     ...                   
886          887       2                   
887          888       1                   
888          889       3           Johnston
889          890       1                   
890          891       3                   

[891 rows x 15 columns], test=     Passenge
0            892       3                   
1            893       3              Wilke
2            894       2                   
3            895       3                   
4            896       3  Hirvonen, Mrs. Al
..           ...     ...                   
413         1305       3                   
414         1306       1                  O
415         1307       3                  S
416         1308       3                   
417         1309       3                   

[418 rows x 15 columns], id=0       892
1       893
2       894
3       895
4       896
       ...
413    1305
414    1306
415    1307
416    1308
417    1309
Name: PassengerId, Length: 418, dtype: int64, label=0      0
1      1
2      1
3      1
4      0
      ..
886    0
887    1
888    0
889    1
890    0
Name: Survived, Length: 891, dtype: int64)
PS C:\Users\bitcamp\Documents\kpmg-250424\kpmg2501\V2\ai-server\titanic-service>  
```


