
ë”¥ëŸ¬ë‹(í•™ìŠµ)ì—ì„œ íŒŒì¼ì€ ëª¨ë¸ì´ë‹¤.

ìµœì´ˆì˜ ëª¨ë¸: 

ë¨¸ì‹ ëŸ¬ë‹ì—ì„œ íŒŒì¼ì€ í•™ìŠµëœ ëª¨ë¸ì´ë‹¤. ì˜ˆ: .xml, .chkt
ë”¥ëŸ¬ë‹ ëª¨ë¸ì—ì„œ CNNì´ ìˆë‹¤.

CNNì€ ë”¥ëŸ¬ë‹ ëª¨ë¸ì˜ êµ¬ì¡°ì´ì, í•™ìŠµëœ íŒŒë¼ë¯¸í„°ë¥¼ í¬í•¨í•œ ëª¨ë¸ ê·¸ ìì²´ì´ë‹¤.



NNê³¼ ë”¥ëŸ¬ë‹ MODEL

- dnnì€ ë”¥ëŸ¬ë‹ì˜ ëª¨ë¸ì´ë‹¤. 
- ëª¨ë¸ì€ êµ¬ì¡°ì´ë‹¤.

**ë¨¸ì‹ ëŸ¬ë‹ì—ì„œ ëª¨ë¸ì€ íŒŒì¼ì´ê³ , ë”¥ëŸ¬ë‹ì—ì„œ ëª¨ë¸ì€ êµ¬ì¡°(íŒŒì¼ì—ë‹¤ê°€ êµ¬ì¡°ê¹Œì§€ í¬í•¨ëœ ê°œë…ì´ë¼ê³  ìƒê°í•˜ê¸°)ì´ë‹¤.**


CNNìœ¼ë¡œ í•˜ë©´ ì •í™•ë„ê°€ ì˜¬ë¼ê°„ë‹¤. -->ì–€ë£¨í°ì´ ê°œë°œí•˜ì˜€ë‹¤.

##### ì–€ ë¥´ì¿¤ì˜ ìš°í¸ë²ˆí˜¸ ìë™ ì¸ì‹ê¸°(ìë™ ë¶„ë¥˜ ì‹œìŠ¤í…œì„ ë§Œë“¤ì—ˆë‹¤.)
- **ë¯¸êµ­ ìš°ì²´êµ­ì—ì„œ ìš°í¸ë¬¼ ìë™ ë¶„ë¥˜ê¸°**ë¥¼ ì—°êµ¬í•˜ë˜ ì¤‘, **ìš°í¸ë²ˆí˜¸ë¥¼ ì†ìœ¼ë¡œ ì“´ ê¸€ì”¨(í•„ê¸°ì²´)ë¡œ ì¸ì‹í•˜ëŠ” ë¬¸ì œ**ë¥¼ í•´ê²°í•˜ê³  ì‹¶ì—ˆìŠµ
ë‹ˆë‹¤.
- **í•„ê¸° ìˆ«ì ì¸ì‹(MNIST)** ë°ì´í„°ì— CNNì„ ì²˜ìŒ ì„±ê³µì ìœ¼ë¡œ ì ìš©í•˜ì˜€ë‹¤. 

- DNNì—ì„œëŠ” ì˜¤ì°¨ê°€ ê±°ì˜ ì—†ë‹¤. ì •í™•ë„ê°€ ê±°ì˜ 99%ì´ë‹¤.


#### ë”¥ëŸ¬ë‹ì˜ 4ëŒ€ ì²œì™•(ì¸ê³µì§€ëŠ¥ ë¶„ì•¼ì—ì„œ)

- ì œí”„ë¦¬ íŒí„´ (Geoffrey Hinton) - ì˜êµ­  
	-  MLP, ì—­ì „íŒŒ ì•Œê³ ë¦¬ì¦˜  
		- ì—­ì „íŒŒ ì•Œê³ ë¦¬ì¦˜ ì´ë€?  
			- ëª¨ë¸ì˜ depthê°€ ê¹Šì–´ì§ˆìˆ˜ë¡, ëª¨ë¸ì˜ ì¸µì´ ë§ì•„ì§ˆìˆ˜ë¡ ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ì˜ ìˆ˜ëŠ” ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ë§ì´ ëŠ˜ì–´ë‚¨.
- ì–€ ë¥´ì¿¤ (Yann LeCun) - í”„ë‘ìŠ¤  
	- CNN(í•©ì„±ê³± ì‹ ê²½ë§) - ì´ë¯¸ì§€ì™€ ê°™ì€ ê·¸ë¦¬ë“œ í˜•íƒœ ë°ì´í„° ì²˜ë¦¬ì— ë§¤ìš° íš¨ê³¼ì ì¸ CNN êµ¬ì¡°  
					- ì»´í“¨í„° ë¹„ì „ ë¶„ì•¼ì—ì„œ ì—„ì²­ë‚œ ì„±ëŠ¥ ê°œì„ ì„ ì´ë£¸.
- ìš”ìˆ˜ì•„ ë²¤ì§€ì˜¤(Yoshua Bengio) - í”„ë‘ìŠ¤  
	- RNN & NLP : Word Embeddigê³¼ ì‹ ê²½ë§ ê¸°ë°˜ ì–¸ì–´ ëª¨ë¸ ì—°êµ¬ì— ì¤‘ìš”í•œ ê¸°ì—¬  
	- _GAN_(Generative Adversarial Nets) : AI ê·¸ë¦¼ ìƒì„±ì˜ ì‹œì´ˆ  
		- ê¸°ê³„ ë²ˆì—­, ì±—ë´‡, í…ìŠ¤íŠ¸ ìƒì„± ë“± í˜„ëŒ€ NLP ê¸°ìˆ  ë°œì „ì— ì§€ëŒ€í•œ ì˜í–¥
- ì•¤ë“œë£¨ ì‘(Andrew Ng) - í™ì½©  
	-Â  2012ë…„ ìœ íŠœë¸Œ ë™ì˜ìƒì—ì„œ ê³ ì–‘ì´ ì–¼êµ´ì„ ìŠ¤ìŠ¤ë¡œ í•™ìŠµí•˜ëŠ” ì‹ ê²½ë§ ì—°êµ¬ëŠ” ë”¥ëŸ¬ë‹ì˜ ê°€ëŠ¥ì„±ì„ ëŒ€ì¤‘ì—ê²Œ ê°ì¸ì‹œí‚¤ëŠ” ì¤‘ìš”í•œ ê³„ê¸°,Â  **Coursera**

#### ë”¥ëŸ¬ë‹ì˜ 4ëŒ€ ì²œì™•....ë¹„ìœ í•˜ìë©´, 
- ì œí”„ë¦¬ íŒí„´ â†’ ì‹ ê²½ë§ì˜ **ê·¼ë³¸ ì² í•™ì**
    
- ì–€ ë¥´ì¿¤ â†’ ì‹œê° ë¶„ì•¼ì˜ **ê±´ì¶•ê°€**
    
- ìš”ìŠˆì•„ ë²¤ì§€ì˜¤ â†’ ì–¸ì–´/ì‹œí€€ìŠ¤ì˜ **íƒí—˜ê°€**
    
- ì•¤ë“œë£¨ ì‘ â†’ ëŒ€ì¤‘ì„ ìœ„í•œ **ì „ë„ì‚¬**


CNN êµ¬ì¡°(Layer)ì˜ ë„ì…

- layer: ì„œë¹„ìŠ¤ ì»¨íŠ¸ë¡¤ëŸ¬ ë“¤ì„ ë§í•œë‹¤.

###### apiì˜ êµ¬ì¡°
- mvc
- msa
- ëª¨ë†€ë¦¬ì‹


ê³¼ì í•©: 
###### cnnì˜ êµ¬ì¡°
- convolutional layer(í•©ì„±ê³± ê³„ì¸µ): íŠ¹ì§• ë§µì„ ì¶”ì¶œí•œë‹¤. 
	- **íŠ¹ì§• ë§µ = CNNì´ ì´ë¯¸ì§€ì—ì„œ ì˜ë¯¸ ìˆëŠ” ì •ë³´ë¥¼ ìˆ«ìë¡œ ì¶”ì¶œí•´ë‚¸ ê²°ê³¼ë¬¼**ì…ë‹ˆë‹¤. 
	- ì´ë¯¸ì§€ì˜ íŠ¹ì§•(ìˆ«ì)ì„ ì¶”ì¶œí•œë‹¤. ì´ë¯¸ì§€ë¥¼ ìˆ«ìì˜ í–‰ë ¬ë¡œ ë°”ê¿”ì„œ ì´í•´í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•¨.
		- ì—¬ê¸°ì„œ íŠ¹ì§•ì´ë¼ëŠ” ê²ƒì€ ì´ë¯¸ì§€, ìŒì„±, í…ìŠ¤íŠ¸ ë“±ì—ì„œ íŒ¨í„´, ê²½í–¥, êµ¬ì¡° ë“± ì¤‘ìš”í•œ ì •ë³´ë¥¼ ìˆ˜ì¹˜ë¡œ í‘œí˜„í•œ ê²ƒì„ ì˜ë¯¸í•œë‹¤.
- pooling layer(í´ë§ ê³„ì¸µ):  
	- í¬ê¸°ë¥¼ ì¤„ì´ê³  ë¶ˆë³€ì„± í™•ë³´ (ì••ì¶• ë° ì €ì¥) - ì˜ì†ì„±ì´ ì €ì¥ì´ë‹¤. ì €ì¥ì€ ë³€í•˜ì§€ ì•ŠëŠ” ê²ƒì„ ë§í•¨. 
- fully connected layer(ì™„ì „ ì—°ê²° ê³„ì¸µ - ì „ê²°í•©ì¸µ):


CNN 
- -> ì´ë¯¸ì§€ë¥¼ ë¶€ë¶„ë³„ë¡œ í”½ì…€ ë‹¨ìœ„ë¡œ ìª¼ê°œëŠ” ê²ƒ? ì„ ë§í•˜ëŠ”ê±°ë‹¤.



í•©ì„±ê³± ë ˆì´ì–´

íŒŒë¼ë¯¸í„°

in_channel: ì…ë ¥ ì±„ë„ ìˆ˜
	channel: ì…ë ¥ë°›ê³  ì¶œë ¥ë°›ëŠ” í†µë¡œ

out_channel: ì¶œë ¥ ì±„ë„ ìˆ˜
kernal_size: ì»¤ë„ì€ ê°€ì¤‘ì¹˜ í–‰ë ¬ë¥¼ ì˜ë¯¸í•œë‹¤. ì»¤ë„ë“¤ì´ ì—¬ëŸ¬ê°œ ì ìš©ë˜ì„œ.... í•„í„°ë¥¼ ë§í•œë‹¤. ì»¤ë„ì˜ ì§‘í•©ì€ í•„í„°ì´ë‹¤. ì»¤ë„ë§ˆë‹¤ 
stride: í•œ ì¹¸ì”© ì›€ì§ì¸ë‹¤.
padding: ê°€ì¥ìë¦¬ë¥¼ ì•Œë ¤ì£¼ëŠ” ,,,,ì—¬ë°±ì—ì„œ ì½ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë‹ˆê¹Œ....



##### í™œì„±í™” í•¨ìˆ˜: í•µì‹¬ ê¸°ëŠ¥ì„ ë‹´ë‹¹í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì˜ë¯¸í•œë‹¤. ì“¸ëª¨ìˆëŠ” ê²ƒë§Œ.....

- **ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜**:** ìŠ¤íŒ¸ì´ëƒ ì•„ë‹ˆëƒì— ë”°ë¼....ì´ì§„ë¶„ë¥˜ì´ë©´ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ ì“´ë‹¤. ê¸°ìš¸ê¸°ê°€ 0ì¸ ìƒíƒœì¼ ë•Œ ì“´ë‹¤.
- **leru:** ê¸°ìš¸ê¸° ì†Œì‹¤ ë¬¸ì œë¥¼ ì¤„ì—¬ì£¼ëŠ” í™œì„±í™” í•¨ìˆ˜ì´ë‹¤. í™œì„±í™” ëœ í•¨ìˆ˜ì˜ ìˆ˜ë¥¼ ì¤„ì´ëŠ” ê²ƒì´ë‹¤. 0 ì´í•˜ì˜ ìˆ«ìë“¤ì€ ë‹¤ ì œê±°í•œë‹¤. positiveí•œ ë°ì´í„°ë§Œ ë‚¨ê²¨ ë†“ëŠ”ë‹¤. ê¸°ìš¸ê¸°ê°€ ì°¨ê°ë  ë•Œ,,ì¦‰ ì¤‘ê°„ì—ì„œ ì“´ë‹¤.
- **ì†Œí”„íŠ¸ ë§¥ìŠ¤:** í™•ë¥ ë¡œì„œ í•˜ë‚˜ ë½‘ì•„ ë‚´ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ê¸°ìš¸ê¸°ê°€ 0ì¸ ìƒíƒœì¼ ë•Œ ì“´ë‹¤.

ìì—°ì–´ë¥¼ ê¸°ê³„ì–´ë¡œ ë³€í™˜í•´ ì£¼ëŠ” ê²ƒì„ ë³€í™˜ê¸°ë¼ê³  í•œë‹¤.ì´ê±¸ **transform**ì´ë¼ê³  í•œë‹¤.



#### RNN vs LSTM vs GRU
##### RNNê³¼ lstm ê·¸ë¦¬ê³  gruëŠ”  ëª¨ë‘ ì‹œí€€ìŠ¤ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë”¥ëŸ¬ë‹ ëª¨ë¸ì´ë‹¤.
- ì‹œí€€ìŠ¤ ëª¨ë¸ì€ 
- ì…ë ¥ê³¼ ì¶œë ¥ ì‚¬ì´ì—, ì€ë‹‰ì¸µì„ ê°–ê³  ìˆëŠ”ë°, ì€ë‹‰ì¸µì€ ìƒíƒœë¥¼ ê°–ê³ ìˆë‹¤. ì´ë•Œ RNNì´ ì“°ì¸ë‹¤.
**RNN**ì¸ë° ìƒíƒœì˜ ê¸°ê°„ì´ ê¸¸ê²Œ ì €ì¥ëœ ê²ƒì„ **LSTM**ì´ë¼ê³  í•œë‹¤.

ì €ì¥ë˜ì–´ ìˆëŠ” ìŠ¤ëƒ… ìƒ·ì´ ì‘ê¸° ë•Œë¬¸ì— ì§§ê²Œ ì €ì¥ë˜ì–´ ìˆë‹¤.--> ë‹¨ê¸° ìƒíƒœì— ìˆë‹¤.


**GRU**: ë¡±í…€ì´ ìƒíƒœê°€ ê¸¸ì–´ì§€ë©´ ëŠë ¤ì§€ë‹ˆê¹Œ......ì¤„ì—¬ì£¼ëŠ” ê²ƒì„ ì˜ë¯¸í•¨. "ì•ˆë…•"ë’¤ì— í•˜ì„¸ìš”...ë‚˜ì˜¬ ìˆ˜ ìˆê²Œë”.....


#### RNNê³„ì—´ vs íŠ¸ëœìŠ¤í¬ë¨¸ ê³„ì—´

|í•­ëª©|**RNN / LSTM / GRU**|**íŠ¸ëœìŠ¤í¬ë¨¸ (Transformer)**|
|---|---|---|
|**ë°ì´í„° ì²˜ë¦¬ ë°©ì‹**|ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬ (í•˜ë‚˜ì”©)|ì „ì²´ ì‹œí€€ìŠ¤ë¥¼ **í•œêº¼ë²ˆì— ë³‘ë ¬ ì²˜ë¦¬**|
|**ì˜ì¡´ì„± ì²˜ë¦¬**|ê°€ê¹Œìš´ ê³¼ê±°ë§Œ ì˜ ê¸°ì–µ|**ë©€ë¦¬ ë–¨ì–´ì§„ ë‹¨ì–´ ê°„ ê´€ê³„ë„ ì˜ ê¸°ì–µ**|
|**ë³‘ë ¬ ì²˜ë¦¬**|ë¶ˆê°€ëŠ¥ (ì‹œê°„ ìˆœì„œëŒ€ë¡œë§Œ)|ê°€ëŠ¥ (GPU í™œìš© ìµœì í™”)|
|**ëŒ€í‘œ êµ¬ì¡°**|ìˆœí™˜ êµ¬ì¡° (Recurrent)|**Self-Attention êµ¬ì¡°**|
|**í•œê³„**|ê¸´ ì‹œí€€ìŠ¤ í•™ìŠµ ì–´ë ¤ì›€, ì†ë„ ëŠë¦¼|ë¹ ë¥´ê³  ì •í™•, í•™ìŠµ íš¨ìœ¨ ë†’ìŒ|
|**ì£¼ë¡œ ì“°ì¸ ì‹œê¸°**|~2017 ì´ì „|2017 ì´í›„ (GPT, BERT ë“± ëŒ€ì„¸)|

- **RNN/LSTM**:  
    ë§ í•œ ë§ˆë””ì”© ìˆœì„œëŒ€ë¡œ ë“¤ì–´ì•¼ ì˜ë¯¸ íŒŒì•…í•¨  
    â†’ "ë‚˜ëŠ”... ì˜¤ëŠ˜... ê¸°ë¶„ì´... ì¢‹ë‹¤"
    
- **íŠ¸ëœìŠ¤í¬ë¨¸**:  
    ë¬¸ì¥ì„ í†µì§¸ë¡œ ë³´ê³  **â€˜ì¢‹ë‹¤â€™ê°€ ì™œ ë‚˜ì™”ëŠ”ì§€ ì•ë’¤ë¥¼ ë‹¤ ê³ ë ¤**í•¨  
    â†’ â€œê¸°ë¶„ì´ ì¢‹ë‹¤â€ê°€ í•µì‹¬ì´ë¼ëŠ” ê±¸ ë¹ ë¥´ê²Œ íŒŒì•…

#### íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ ëŒ€í‘œ ëª¨ë¸ë“¤(RNN ê°œì„ ëœ ë¸Œëœë“œ)
- ë””ì½”ë” í•  ë•Œ, ì•„ë˜ ì£¼

|ì´ë¦„|ì„¤ëª…|
|---|---|
|**GPT (OpenAI)**|ChatGPT ëª¨ë¸, ë¬¸ì¥ ìƒì„±ì— ê°•í•¨|
|**BERT (Google)**|ë¬¸ì¥ ì´í•´/ë¶„ë¥˜ì— ê°•í•¨|
|**T5 (Google)**|í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥â†’ì¶œë ¥ ë¬¸ì œë¡œ í†µì¼ (ë²ˆì—­, ìš”ì•½ ë“±)|
|**BART (Meta)**|GPT + BERT êµ¬ì¡° í˜¼í•© (í…ìŠ¤íŠ¸ ë³µì›, ìƒì„±)|
|**LLAMA (Meta)**|ì˜¤í”ˆì†ŒìŠ¤ ëŒ€í˜• ì–¸ì–´ ëª¨ë¸|
|**PaLM, Gemini (Google)**|ëŒ€í˜• ëª¨ë¸ ê³„ì—´ë¡œ í™•ì¥ ì¤‘|
#### RNN, LSTM, GRUì˜ ê´€ê³„ (í¬ê¸° ë¹„êµ)
- LSTM/GRUëŠ” **ì„±ëŠ¥ê³¼ ê¸°ì–µë ¥ í–¥ìƒì„ ìœ„í•´ ë“±ì¥í•œ RNNì˜ ê°œì„ í˜•**ì´ì—ìš”.

| ê³„ì¸µ êµ¬ì¡°                    |
| ------------------------ |
| ğŸ§  RNN (ê¸°ë³¸ êµ¬ì¡°)           |
| â†³ ğŸ§  LSTM (ì¥ê¸° ê¸°ì–µ ê°•í™”)     |
| â†³ ğŸ§  GRU (LSTMë³´ë‹¤ ê°€ë³ê³  ë¹ ë¦„) |


#### ì½”í¼ìŠ¤: ì–¸ì–´ ëª¨ë¸ì´ ê³µë¶€í•˜ëŠ” êµê³¼ì„œ
- ëª…ì‚¬ ìœ„ì£¼ë¡œë§Œ ë‚˜ì™€ìˆëŠ” ë”•ì…”ë„ˆë¦¬...ìì—°ì–´ ì‚¬ì „ì´ë‹¤.


##### ì›- í•« ì¸ì½”ë”© vs ì›Œë“œ ì„ë°°ë”©

- ì›-í•« ì¸ì½”ë”©ì˜ ê°œì„ ì•ˆ : ì›Œë“œ ì„ë°°ë”©
- ì›í•«ì¸ì½”ë”©ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ ê²ƒë“¤ì„ ëª¨ì•„ë†“ì€ ê²ƒì„ ì›Œë“œ ì„ë² ë”©ì´ë¼ê³  í•œë‹¤. ì›í•«ì¸ì½”ë”©ì€ 0ê³¼ 1ë¡œ ë˜ì–´ìˆë‹¤.ì •ìˆ˜ì´ë‹¤.

- ì›Œë“œ ì„ë°°ë”©: ì‹¤ìˆ˜ë¡œ ë˜ì–´ìˆê³ , í™•ë¥ ë¡œ ë‚˜ì˜¨ë‹¤. ì„ë² ë”©ì€ ìœ ì‚¬í•œ ê²ƒì„ ëª¨ì•„ ë…¼ ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, iì¼ ê²½ìš°, he, she, theyë¥¼ ê°€ì§€ê³  ìˆëŠ” ì„ë² ë”©ì„ ê°€ì§€ê³  ì˜¨ë‹¤ë¼ê³  í•  ìˆ˜ ìˆë‹¤. 

##### sparse vs dense
- sparse: í¬ì†Œí•˜ë‹¤

- dense: ë°€ì§‘ë˜ì–´ ìˆë‹¤.

í† í¬ë‚˜ì´ì € = í† í°í™”: ëª…ì‚¬ë§Œ ë‚¨ê²¨ë‘ê³  ì¡°ì‚¬ëŠ” ëº€ë‹¤. ì˜ˆ: "ì•„ë²„ì§€ê°€ ë°©ì— ë“¤ì–´ê°€ì…¨ìŠµë‹ˆë‹¤" ì—ì„œ ì•„ë²„ì§€, ë°©....


##### ì„¼í…ìŠ¤í”¼ìŠ¤: í† í°í™” ì‘ì—… ì¤‘ í•˜ë‚˜ì´ë‹¤. ì„¼í„´ìŠ¤ë¥¼ ì¡°ê°ì‹œí‚¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

##### í—ˆê¹… í˜ì´ìŠ¤: ìì—°ì–´ ì²˜ë¦¬(NLP) í”Œë«í¼ íšŒì‚¬ì´ë‹¤.


ì¸ì½”ë”ì™€ ë””ì½”ë” ë‘ê°œ ë‹¤ ì¨ì•¼í•œë‹¤.(ì˜í•œ ì‚¬ì „, í•œì˜ì‚¬ì „ ë‘ê°œ ë‹¤ í•„ìš”í•˜ë‹ˆê¹Œ...)

- ì¸ì½”ë”: ì¸ì½”ë”© í•´ì£¼ëŠ” ê²ƒ
	- ì¸ì½”ë”©: ìì—°ì–´ --> ê¸°ê³„ì–´

- ë””ì½”ë”: ë””ì½”ë”© í•´ì£¼ëŠ” ê²ƒ()
	- ë””ì½”ë”©: ê¸°ê³„ì–´ --> ìì—°ì–´

bertëŠ” êµ¬ê¸€ êº¼ì´ë‹¤.



**í”„ë¡¬í”„íŒ…**(ì˜¤ëŠ˜ì˜ ê³¼ì œ...ì¸ì‚¬ë§..ë‚˜ì˜¤ê²Œë”... ì•ˆë…•í•˜ì„¸ìš” í•˜ë©´ ê°ì‚¬í•©ë‹ˆë‹¤ê¹Œì§€ ë‚˜ì˜¤ê²Œë”....ì˜¤ëŠ˜ì˜ ëª©í‘œ)
- ë‚´ê°€ í•œêµ­ì–´ë¡œ ëœ ì±—ë´‡ì„ ì œì‘í•˜ë ¤ê³  í•´. ë‹¹ì—°íˆ RNNì„ ì“¸êº¼ì•¼. í—ˆê¹… í˜ì´ìŠ¤ì—ì„œ í•œêµ­ì–´ê°€ ì˜ í›ˆë ¨ëœ ëª¨ë¸ì„ ë„ˆê°€ ì¶”ì²œí•´ì¤˜...í•˜ê³ ë‚˜ì„œ.. ì•„ë˜ ë§í¬ë¥¼ ì¶”ì²œí•´ì¤Œ. https://huggingface.co/skt/kobert-base-v1ì´ê²ƒì„ ì„ íƒí–ˆì„ ë•Œ, í•œêµ­ì–´ ì¸ì‚¬ë¥¼ í•˜ëŠ” ì±—ë´‡ì„ msaêµ¬ì¡°ë¡œ ê°œë°œí•˜ë ¤ê³  í•´. ì´ë•Œ ai-serverë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ê°„ë‹¨í•˜ê²Œ ì†Œê°œí•´ì¤˜.


### ì‹œí€€ìŠ¤ íˆ¬ ì‹œí€€ìŠ¤: 
- ì§ˆë¬¸ê³¼ ëŒ€ë‹µìœ¼ë¡œ êµ¬ì„±í•´ì„œ ì±—ë´‡ì„ ë§Œë“¤ì–´ì„œ ,,,,ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

ì…ë ¥ ì‹œí€€ìŠ¤ì™€ ì¶œë ¥ ì‹œí€€ìŠ¤...



##### CNNê³¼ RNNì˜ ì°¨ì´

|í•­ëª©|**CNN (Convolutional Neural Network)**|**RNN (Recurrent Neural Network)**|
|---|---|---|
|**ì£¼ë¡œ ì“°ì´ëŠ” ë¶„ì•¼**|ì´ë¯¸ì§€, ì˜ìƒ ì²˜ë¦¬|ì–¸ì–´, ìŒì„±, ì‹œê³„ì—´ ë°ì´í„°|
|**ì…ë ¥ êµ¬ì¡°**|2ì°¨ì› (ì˜ˆ: ì´ë¯¸ì§€ í”½ì…€)|ìˆœì°¨ì  ë°ì´í„° (ë¬¸ì¥, ì‹œê°„ íë¦„)|
|**í•µì‹¬ ê¸°ëŠ¥**|ê³µê°„ì ì¸ íŒ¨í„´ ê°ì§€ (ì—£ì§€, ìœ¤ê³½ ë“±)|ì‹œê°„ì  ìˆœì„œì™€ íë¦„ ì´í•´|
|**ì˜ˆì‹œ**|ê³ ì–‘ì´ ì´ë¯¸ì§€ ë¶„ë¥˜, ì–¼êµ´ ì¸ì‹|ë²ˆì—­, ì±—ë´‡, ê°ì • ë¶„ì„, ì£¼ê°€ ì˜ˆì¸¡|


##### ì–´í…ì…˜(attention)
- ì´ ì „ê¹Œì§€ì˜ ê³¼ì •ì„ ê²€í† í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì³‡ ì§€í”¼í‹°ì—ì„œ ìš°ë¦¬ê°€ ê³„ì† ëŒ€í™” í–ˆë˜ ë‚´ìš©ë“¤ì„ ê²€í† í•´ì„œ.....ê·¸ë˜ì„œ ì³‡ ì§€í”¼í‹°ëŠ” ì–´í…ì…˜ ê¸°ë²•ì„ ê°€ì§€ê³  ìˆë‹¤ë¼ê³  ë§í•  ìˆ˜ ìˆë‹¤.
	- timeì´ ë“¤ì–´ê°€ë©´ ìƒíƒœë¥¼ ìƒê°í•˜ë©´ ëœë‹¤.

#### faiss -  ë¼ì´ë¸ŒëŸ¬ë¦¬
- ì„ë°°ë”©ì„ ì“´ë‹¤ëŠ” ê²ƒì€ faissë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.


ìì—°ì–´ ì²˜ë¦¬í•  ë•Œ, bertì™€ gpt ì¤‘ì— ê³¨ë¥´ë©´ ëœë‹¤. gptì—ë„ ì—¬ëŸ¬ ì¢…ë¥˜ê°€ ìˆë‹¤. GPT ê¸°ë°˜ ëª¨ë¸ì€ **í…ìŠ¤íŠ¸ ìƒì„± ëŠ¥ë ¥ì´ ë›°ì–´ë‚˜ì„œ ì±—ë´‡ ì œì‘ì— ë§¤ìš° ì í•©**í•˜ê³ ,  **ë¡œì»¬ì—ì„œ ë¬´ë£Œë¡œ ì„¤ì¹˜ ê°€ëŠ¥í•œ ë²„ì „**ë„ ë‹¤ì–‘í•˜ê²Œ ì¡´ì¬í•©ë‹ˆë‹¤.

| ëª¨ë¸ ì´ë¦„                            | í¬ê¸°          | ì–¸ì–´        | íŠ¹ì§•                   |
| -------------------------------- | ----------- | --------- | -------------------- |
| **GPT2 (OpenAI)**                | 124M ~ 1.5B | ì˜ì–´        | ì™„ì „ ê³µê°œ, ë¹ ë¦„, ì—°ìŠµìš© ì¢‹ìŒ    |
| **KoGPT2 (KakaoBrain)**          | 125M        | í•œêµ­ì–´       | í•œêµ­ì–´ GPT2 ë²„ì „, ê°€ë³ê³  ë¹ ë¦„  |
| **KoAlpaca-Polyglot** (by Beomi) | 12.8B       | í•œêµ­ì–´ + ë‹¤êµ­ì–´ | ëª…ë ¹ì–´/í”„ë¡¬í”„íŠ¸ ì‘ë‹µ íŠ¹í™”       |
| **OpenChatKit, OpenAssistant**   | 6B~13B      | ë‹¤êµ­ì–´       | ì±—ë´‡ ì§€í–¥ ëª¨ë¸, ë¡œì»¬ ì±—GPT ëŒ€ì•ˆ |
| **Mistral-7B-Instruct**          | 7B          | ì˜ì–´        | ê³ ì„±ëŠ¥, RAM 16GB ì´ìƒ ê¶Œì¥  |
| **Phi-2 (MS)**                   | 2.7B        | ì˜ì–´        | ì†Œí˜• ê³ ì„±ëŠ¥ GPT ìŠ¤íƒ€ì¼ ëª¨ë¸    |
| **TinyLlama**                    | 1.1B        | ì˜ì–´        | ì´ˆê²½ëŸ‰, ë…¸íŠ¸ë¶ì—ì„œë„ ì‘ë™ ê°€ëŠ¥    |
|                                  |             |           |                      |

##### mnist_service.pyë¥¼ ë§Œë“¤ì–´ì„œ, mnist ë§Œë“¤ê¸°.... 

mnistë€?
- ì†ìœ¼ë¡œ ì“´ ìˆ«ì(0~9)ì˜ í‘ë°± ì´ë¯¸ì§€ë¥¼ ëª¨ì•„ ë§Œë“  ì†ê¸€ì”¨ ìˆ«ì ì´ë¯¸ì§€ ë°ì´í„° ì…‹ì´ë‹¤.
	- ì—¬ê¸°ì„œ ë°ì´í„° ì…‹ì€ AIë‚˜ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì´ í•™ìŠµí•˜ê±°ë‚˜ í…ŒìŠ¤íŠ¸í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„° ëª¨ìŒì„ ì˜ë¯¸í•œë‹¤. ì¦‰, ë°ì´í„°ì…‹(dataset)**ì€ **ì»´í“¨í„°ê°€ í•™ìŠµí•˜ê±°ë‚˜ í‰ê°€í•  ìˆ˜ ìˆë„ë¡ ì •ë¦¬ëœ â€œë°ì´í„°ì˜ ì§‘í•©ì„ ì˜ë¯¸í•œë‹¤.
	

(í”„ë¡¬í”„íŒ…)
CNNì„ ì‚¬ìš©í•´ì„œ ì‚¬ì§„ì— ì í˜€ìˆëŠ” ìˆ«ìë¥¼ ì¸ì‹í•˜ë ¤ê³ í•´. ë‚˜ëŠ” ì§€ê¸ˆ msaêµ¬ì¡°ì—ì„œ íŒŒì¼ ì—…ë¡œë“œí•´ì„œ ìˆ«ìë¥¼ ì¸ì‹í•˜ê²Œ í• êº¼ì•¼. ê·¼ë° ì´ë¯¸ íŒŒì¼ ì—…ë¡œë“œ í•˜ëŠ” ë°©ì‹ì€ ê°–ì¶°ì¡Œì–´.


```
import os

from fastapi import APIRouter, File, UploadFile, Path, Query, Body

from fastapi.responses import JSONResponse

from pydantic import BaseModel

import shutil

import logging

import cv2

import matplotlib.pyplot as plt

from tensorflow import keras

import numpy as np

  

router = APIRouter()

logger = logging.getLogger("tf_main")

  

# ì—…ë¡œë“œ ë””ë ‰í† ë¦¬ì™€ ì¶œë ¥ ë””ë ‰í† ë¦¬ë¥¼ app ë‚´ë¶€ë¡œ ê³ ì •

BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))

UPLOAD_DIR = os.path.join(BASE_DIR, "uploads")

OUTPUT_DIR = os.path.join(BASE_DIR, "output")

os.makedirs(UPLOAD_DIR, exist_ok=True)

os.makedirs(OUTPUT_DIR, exist_ok=True)

logger.info(f"íŒŒì¼ ì—…ë¡œë“œ ë””ë ‰í† ë¦¬: {UPLOAD_DIR}")

logger.info(f"íŒŒì¼ ì¶œë ¥ ë””ë ‰í† ë¦¬: {OUTPUT_DIR}")

  

# MNIST ê´€ë ¨ ìš”ì²­ ëª¨ë¸

class MnistSampleRequest(BaseModel):

Â  Â  index: int = 100 Â # ê¸°ë³¸ê°’ì€ 100ë²ˆì§¸ ì´ë¯¸ì§€

Â  Â  filename: str = "mnist_sample.png" Â # ê¸°ë³¸ íŒŒì¼ëª…

Â  Â  add_noise: bool = False Â # ë…¸ì´ì¦ˆ ì¶”ê°€ ì—¬ë¶€

  

# MNIST ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„± ì—”ë“œí¬ì¸íŠ¸ (GET)

@router.get("/mnist-sample")

async def get_mnist_sample():

Â  Â  """

Â  Â  MNIST ë°ì´í„°ì…‹ì—ì„œ 100ë²ˆì§¸ ì´ë¯¸ì§€ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

Â  Â  ì´ë¯¸ì§€ëŠ” mnist ë””ë ‰í† ë¦¬ì— mnist_sample.png íŒŒì¼ë¡œ ì €ì¥ë˜ê³ , ë ˆì´ë¸”ì€ JSONìœ¼ë¡œ ë°˜í™˜ë©ë‹ˆë‹¤.

Â  Â  **Returns**:

Â  Â  - **label**: ì´ë¯¸ì§€ì˜ ë ˆì´ë¸” (ìˆ«ì 0-9)

Â  Â  - **image_path**: ì €ì¥ëœ ì´ë¯¸ì§€ íŒŒì¼ ê²½ë¡œ

Â  Â  """

Â  Â  try:

Â  Â  Â  Â  # MNIST ë°ì´í„°ì…‹ ë¡œë“œ

Â  Â  Â  Â  mnist = keras.datasets.mnist

Â  Â  Â  Â  (train_images, train_labels), (_, _) = mnist.load_data()

Â  Â  Â  Â  # 100ë²ˆì§¸ ì´ë¯¸ì§€ ì„ íƒ

Â  Â  Â  Â  mnist_idx = 100

Â  Â  Â  Â  image = train_images[mnist_idx]

Â  Â  Â  Â  label = int(train_labels[mnist_idx])

Â  Â  Â  Â  # ì´ë¯¸ì§€ íŒŒì¼ ì €ì¥ ê²½ë¡œ ì„¤ì •

Â  Â  Â  Â  mnist_dir = os.path.join(OUTPUT_DIR, "mnist")

Â  Â  Â  Â  os.makedirs(mnist_dir, exist_ok=True)

Â  Â  Â  Â  image_path = os.path.join(mnist_dir, "mnist_sample.png")

Â  Â  Â  Â  # Matplotlibì„ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ì§€ ì €ì¥

Â  Â  Â  Â  plt.figure(figsize=(5, 5))

Â  Â  Â  Â  plt.imshow(image, cmap='gray')

Â  Â  Â  Â  plt.axis('off') Â # ì¶• ì œê±°

Â  Â  Â  Â  plt.savefig(image_path, bbox_inches='tight', pad_inches=0)

Â  Â  Â  Â  plt.close()

Â  Â  Â  Â  logger.info(f"MNIST ìƒ˜í”Œ ì´ë¯¸ì§€(ì¸ë±ìŠ¤: {mnist_idx}, ë ˆì´ë¸”: {label})ê°€ {image_path}ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")

Â  Â  Â  Â  # ì‘ë‹µ ë°˜í™˜

Â  Â  Â  Â  return {

Â  Â  Â  Â  Â  Â  "label": label,

Â  Â  Â  Â  Â  Â  "image_path": image_path

Â  Â  Â  Â  }

Â  Â  except Exception as e:

Â  Â  Â  Â  logger.error(f"MNIST ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„± ì˜¤ë¥˜: {str(e)}")

Â  Â  Â  Â  return JSONResponse(

Â  Â  Â  Â  Â  Â  content={"error": f"MNIST ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {str(e)}"},

Â  Â  Â  Â  Â  Â  status_code=500

Â  Â  Â  Â  )

  

# MNIST ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„± ì—”ë“œí¬ì¸íŠ¸ (POST)

@router.post("/mnist-sample")

async def post_mnist_sample(request: MnistSampleRequest = Body(...)):

Â  Â  """

Â  Â  MNIST ë°ì´í„°ì…‹ì—ì„œ ì§€ì •ëœ ì¸ë±ìŠ¤ì˜ ì´ë¯¸ì§€ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

Â  Â  **Request Body**:

Â  Â  - **index**: ì´ë¯¸ì§€ ì¸ë±ìŠ¤ (0-59999)

Â  Â  - **filename**: ì €ì¥í•  íŒŒì¼ëª…

Â  Â  - **add_noise**: ë…¸ì´ì¦ˆ ì¶”ê°€ ì—¬ë¶€

Â  Â  **Returns**:

Â  Â  - **label**: ì´ë¯¸ì§€ì˜ ë ˆì´ë¸” (ìˆ«ì 0-9)

Â  Â  - **image_path**: ì €ì¥ëœ ì´ë¯¸ì§€ íŒŒì¼ ê²½ë¡œ

Â  Â  - **has_noise**: ë…¸ì´ì¦ˆ ì¶”ê°€ ì—¬ë¶€

Â  Â  """

Â  Â  try:

Â  Â  Â  Â  # MNIST ë°ì´í„°ì…‹ ë¡œë“œ

Â  Â  Â  Â  mnist = keras.datasets.mnist

Â  Â  Â  Â  (train_images, train_labels), (_, _) = mnist.load_data()

Â  Â  Â  Â  # ì¸ë±ìŠ¤ ë²”ìœ„ í™•ì¸

Â  Â  Â  Â  if request.index < 0 or request.index >= len(train_images):

Â  Â  Â  Â  Â  Â  return JSONResponse(

Â  Â  Â  Â  Â  Â  Â  Â  content={"error": f"ìœ íš¨í•˜ì§€ ì•Šì€ ì¸ë±ìŠ¤: {request.index}, 0-{len(train_images)-1} ë²”ìœ„ ë‚´ì—ì„œ ì§€ì •í•´ì£¼ì„¸ìš”."},

Â  Â  Â  Â  Â  Â  Â  Â  status_code=400

Â  Â  Â  Â  Â  Â  )

Â  Â  Â  Â  # ì§€ì •ëœ ì¸ë±ìŠ¤ì˜ ì´ë¯¸ì§€ ì„ íƒ

Â  Â  Â  Â  image = train_images[request.index].copy() Â # ì›ë³¸ ë°ì´í„° ë³€ê²½ ë°©ì§€ë¥¼ ìœ„í•œ ë³µì‚¬

Â  Â  Â  Â  label = int(train_labels[request.index])

Â  Â  Â  Â  # ë…¸ì´ì¦ˆ ì¶”ê°€ (ìš”ì²­ëœ ê²½ìš°)

Â  Â  Â  Â  has_noise = False

Â  Â  Â  Â  if request.add_noise:

Â  Â  Â  Â  Â  Â  noise = np.random.normal(0, 15, image.shape)

Â  Â  Â  Â  Â  Â  image = np.clip(image + noise, 0, 255).astype(np.uint8)

Â  Â  Â  Â  Â  Â  has_noise = True

Â  Â  Â  Â  # ì´ë¯¸ì§€ íŒŒì¼ ì €ì¥ ê²½ë¡œ ì„¤ì •

Â  Â  Â  Â  mnist_dir = os.path.join(OUTPUT_DIR, "mnist")

Â  Â  Â  Â  os.makedirs(mnist_dir, exist_ok=True)

Â  Â  Â  Â  # íŒŒì¼ëª…ì— ë ˆì´ë¸”ê³¼ ë…¸ì´ì¦ˆ ì •ë³´ ì¶”ê°€

Â  Â  Â  Â  filename_base = os.path.splitext(request.filename)[0]

Â  Â  Â  Â  filename_ext = os.path.splitext(request.filename)[1] or ".png"

Â  Â  Â  Â  noise_suffix = "_noise" if has_noise else ""

Â  Â  Â  Â  final_filename = f"{filename_base}_label{label}{noise_suffix}{filename_ext}"

Â  Â  Â  Â  image_path = os.path.join(mnist_dir, final_filename)

Â  Â  Â  Â  # Matplotlibì„ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ì§€ ì €ì¥

Â  Â  Â  Â  plt.figure(figsize=(5, 5))

Â  Â  Â  Â  plt.imshow(image, cmap='gray')

Â  Â  Â  Â  plt.axis('off') Â # ì¶• ì œê±°

Â  Â  Â  Â  plt.savefig(image_path, bbox_inches='tight', pad_inches=0)

Â  Â  Â  Â  plt.close()

Â  Â  Â  Â  logger.info(f"MNIST ìƒ˜í”Œ ì´ë¯¸ì§€(ì¸ë±ìŠ¤: {request.index}, ë ˆì´ë¸”: {label}, ë…¸ì´ì¦ˆ: {has_noise})ê°€ {image_path}ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")

Â  Â  Â  Â  # ì‘ë‹µ ë°˜í™˜

Â  Â  Â  Â  return {

Â  Â  Â  Â  Â  Â  "label": label,

Â  Â  Â  Â  Â  Â  "image_path": image_path,

Â  Â  Â  Â  Â  Â  "has_noise": has_noise

Â  Â  Â  Â  }

Â  Â  except Exception as e:

Â  Â  Â  Â  logger.error(f"MNIST ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„± ì˜¤ë¥˜: {str(e)}")

Â  Â  Â  Â  return JSONResponse(

Â  Â  Â  Â  Â  Â  content={"error": f"MNIST ìƒ˜í”Œ ì´ë¯¸ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {str(e)}"},

Â  Â  Â  Â  Â  Â  status_code=500

Â  Â  Â  Â  )

  

@router.post("/upload")

async def upload_file(file: UploadFile = File(...)):

Â  Â  file_location = os.path.join(UPLOAD_DIR, file.filename)

Â  Â  logger.info(f"íŒŒì¼ ì—…ë¡œë“œ ì‹œì‘: {file.filename}, ì €ì¥ ìœ„ì¹˜: {file_location}")

Â  Â  try:

Â  Â  Â  Â  with open(file_location, "wb") as buffer:

Â  Â  Â  Â  Â  Â  shutil.copyfileobj(file.file, buffer)

Â  Â  Â  Â  logger.info(f"íŒŒì¼ ì—…ë¡œë“œ ì„±ê³µ: {file.filename}")

Â  Â  Â  Â  if os.path.exists(file_location):

Â  Â  Â  Â  Â  Â  file_size = os.path.getsize(file_location)

Â  Â  Â  Â  Â  Â  logger.info(f"íŒŒì¼ ì €ì¥ í™•ì¸: {file_location}, í¬ê¸°: {file_size} bytes")

Â  Â  Â  Â  else:

Â  Â  Â  Â  Â  Â  logger.error(f"íŒŒì¼ì´ ì €ì¥ë˜ì§€ ì•ŠìŒ: {file_location}")

Â  Â  Â  Â  return JSONResponse(content={"filename": file.filename, "message": "íŒŒì¼ ì—…ë¡œë“œ ì„±ê³µ!", "path": file_location})

Â  Â  except Exception as e:

Â  Â  Â  Â  logger.error(f"íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨: {str(e)}")

Â  Â  Â  Â  return JSONResponse(content={"error": str(e)}, status_code=500)

  

@router.get("/mosaic")

async def mosaic_all_uploads():

Â  Â  cascade = os.path.join(BASE_DIR, 'data', 'haarcascade_frontalface_alt.xml')

Â  Â  face_cascade = cv2.CascadeClassifier(cascade)

Â  Â  processed_files = []

Â  Â  failed_files = []

  

Â  Â  for filename in os.listdir(UPLOAD_DIR):

Â  Â  Â  Â  if filename.lower().endswith(('.png', '.jpg', '.jpeg', '.bmp', '.gif')):

Â  Â  Â  Â  Â  Â  img_path = os.path.join(UPLOAD_DIR, filename)

Â  Â  Â  Â  Â  Â  img = cv2.imread(img_path)

Â  Â  Â  Â  Â  Â  if img is None:

Â  Â  Â  Â  Â  Â  Â  Â  failed_files.append(filename)

Â  Â  Â  Â  Â  Â  Â  Â  continue

Â  Â  Â  Â  Â  Â  face = face_cascade.detectMultiScale(img, minSize=(30,30))

Â  Â  Â  Â  Â  Â  if len(face) == 0:

Â  Â  Â  Â  Â  Â  Â  Â  logger.error(f'ì–¼êµ´ì¸ì‹ ì‹¤íŒ¨: {filename}')

Â  Â  Â  Â  Â  Â  Â  Â  failed_files.append(filename)

Â  Â  Â  Â  Â  Â  Â  Â  continue

Â  Â  Â  Â  Â  Â  for (x, y, w, h) in face:

Â  Â  Â  Â  Â  Â  Â  Â  logger.info(f'{filename} ì–¼êµ´ì˜ ì¢Œí‘œ = {x}, {y}, {w}, {h}')

Â  Â  Â  Â  Â  Â  Â  Â  # ì–¼êµ´ ì˜ì—­ ì˜ë¼ë‚´ê¸°

Â  Â  Â  Â  Â  Â  Â  Â  face_img = img[y:y+h, x:x+w]

Â  Â  Â  Â  Â  Â  Â  Â  # ëª¨ìì´í¬(í”½ì…€í™”) ì ìš©

Â  Â  Â  Â  Â  Â  Â  Â  mosaic = cv2.resize(face_img, (16, 16), interpolation=cv2.INTER_LINEAR)

Â  Â  Â  Â  Â  Â  Â  Â  mosaic = cv2.resize(mosaic, (w, h), interpolation=cv2.INTER_NEAREST)

Â  Â  Â  Â  Â  Â  Â  Â  # ì›ë³¸ ì´ë¯¸ì§€ì— ë‹¤ì‹œ ë¶™ì´ê¸°

Â  Â  Â  Â  Â  Â  Â  Â  img[y:y+h, x:x+w] = mosaic

Â  Â  Â  Â  Â  Â  output_path = os.path.join(OUTPUT_DIR, f"{os.path.splitext(filename)[0]}-face.png")

Â  Â  Â  Â  Â  Â  cv2.imwrite(output_path, img)

Â  Â  Â  Â  Â  Â  processed_files.append(output_path)

  

Â  Â  return JSONResponse(content={

Â  Â  Â  Â  "message": "ëª¨ìì´í¬ ì²˜ë¦¬ ì™„ë£Œ",

Â  Â  Â  Â  "processed_files": processed_files,

Â  Â  Â  Â  "failed_files": failed_files

Â  Â  })
```